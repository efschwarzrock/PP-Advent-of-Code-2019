#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>

//678
//int i[] = {3,12,6,12,15,1,13,14,13,4,13,99,-1,0,1,9};
void partOne(){
	int max = 0;
	int zz = 1234;
	while(zz < 44000){
	int output = 0;
	int za = zz%10;
	int zb = zz/10%10;
	int zc = zz/100%10;
	int zd = zz/1000%10;
	int ze = zz/10000%10;
	if(za != zb && za != zc && za != zd && za != ze && zb != zc && zb != zd && zb != ze && zc != zd && zc != ze  && ze != zd){
	int inputa[] = {za, zb, zc, zd, ze}; 	
	int xx = 0;
	int inputb = 0;
	while(xx<5){	
	int i[] = {3,8,1001,8,10,8,105,1,0,0,21,38,63,88,97,118,199,280,361,442,99999,3,9,1002,9,3,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,101,3,9,9,102,5,9,9,101,3,9,9,1002,9,3,9,101,3,9,9,4,9,99,3,9,1002,9,2,9,1001,9,3,9,102,3,9,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,102,2,9,9,4,9,99,3,9,102,4,9,9,101,5,9,9,102,2,9,9,101,5,9,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,1,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,99};
	int x = 0;
	int com = 0;
	int valA = 0;
	int valB = 0;
	int desC = 0;
	int done = -1;
	bool first = true;
	while(x < 678 && done == -1){
		//printf("here\n");
		com = i[x];
		int comand = com%100;
		//printf("comand = %d\n", comand);
		//printf("x = %d\n", x);
		com = com/100;
		int pa = com%10;
		int pb = com/10%10;
		int pc = com/100%10;
		if(comand < 3){
			if(pa == 0){
				valA = i[i[x+1]];
			}else{
				valA = i[x+1];
			}
			if(pb == 0){
				valB = i[i[x+2]];
			}else{
				valB = i[x+2];
			}
			desC = i[x+3];
			
			if(comand == 1){
				i[desC] = valA + valB;
				//printf("add %d + %d\n", valA, valB);
			}else if( comand == 2){
				i[desC] = valA *valB;
			}
			x = x + 4;
		}else if(comand < 5){
			//printf("here\n");
			desC = i[x+1];
			if(comand == 3){
				if(first){
				//printf("here\n");
				i[desC] = inputa[xx];
				first = false;
				}else{
				i[desC] = inputb;
				}
			}else{
				output = i[desC];
				printf("output = %d\n", output);
			}
			x = x + 2;
		}else if(comand < 7){
			if(pa == 0){
				valA = i[i[x+1]];
			}else{
				valA = i[x+1];
			}
			if(pb == 0){
				valB = i[i[x+2]];
			}else{
				valB = i[x+2];
			}
			if(comand == 5){
				if(valA == 0){
					x = x + 3;
				}else{
					x = valB;
				}
			}else{
				if(valA != 0){
					x = x + 3;
				}else{
					x = valB;
				}
			}
		}else if(comand < 9){
			desC = i[x+3];
			if(pa == 0){
				valA = i[i[x+1]];
			}else{
				valA = i[x+1];
			}
			if(pb == 0){
				valB = i[i[x+2]];
			}else{
				valB = i[x+2];
			}
			if(comand == 7){
				if(valA < valB){
					i[desC] = 1;
				}else{
					i[desC] = 0;
				}
			}else{
				if(valA == valB){
					i[desC] = 1;
				}else{
					i[desC] = 0;
				}
			}
			x = x + 4;
		}else if(comand == 99){
			printf("halt\n");
			done = 0;
		}else{
			printf("error");
			done = 1;
		}
	}
	inputb = output;
	xx++;
	}
	if(output > max){
		max = output;
	}
	}
	zz++;
	}
	printf("%d done\n", max);

}

void partTwo(){
	int max = 0;
	int zz = 56789;
	while(zz < 98769){
	int output = 0;
	int za = zz%10;
	int zb = zz/10%10;
	int zc = zz/100%10;
	int zd = zz/1000%10;
	int ze = zz/10000%10;
	if(za != zb && za != zc && za != zd && za != ze && zb != zc && zb != zd && zb != ze && zc != zd && zc != ze  && ze != zd){
	int inputa[] = {za, zb, zc, zd, ze};
	int xx; 
	if(za > 4 && zb > 4 && zc > 4 && zd > 4 && ze > 4){	
		xx = 0;
	}else{
		xx = 9;
	}
	int inputb = 0;
	bool first[] = {true, true, true, true, true};
	while(xx<5){	
	int i[][523] = {{3,8,1001,8,10,8,105,1,0,0,21,38,63,88,97,118,199,280,361,442,99999,3,9,1002,9,3,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,101,3,9,9,102,5,9,9,101,3,9,9,1002,9,3,9,101,3,9,9,4,9,99,3,9,1002,9,2,9,1001,9,3,9,102,3,9,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,102,2,9,9,4,9,99,3,9,102,4,9,9,101,5,9,9,102,2,9,9,101,5,9,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,1,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,99},
			{3,8,1001,8,10,8,105,1,0,0,21,38,63,88,97,118,199,280,361,442,99999,3,9,1002,9,3,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,101,3,9,9,102,5,9,9,101,3,9,9,1002,9,3,9,101,3,9,9,4,9,99,3,9,1002,9,2,9,1001,9,3,9,102,3,9,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,102,2,9,9,4,9,99,3,9,102,4,9,9,101,5,9,9,102,2,9,9,101,5,9,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,1,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,99},
			{3,8,1001,8,10,8,105,1,0,0,21,38,63,88,97,118,199,280,361,442,99999,3,9,1002,9,3,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,101,3,9,9,102,5,9,9,101,3,9,9,1002,9,3,9,101,3,9,9,4,9,99,3,9,1002,9,2,9,1001,9,3,9,102,3,9,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,102,2,9,9,4,9,99,3,9,102,4,9,9,101,5,9,9,102,2,9,9,101,5,9,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,1,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,99},
			{3,8,1001,8,10,8,105,1,0,0,21,38,63,88,97,118,199,280,361,442,99999,3,9,1002,9,3,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,101,3,9,9,102,5,9,9,101,3,9,9,1002,9,3,9,101,3,9,9,4,9,99,3,9,1002,9,2,9,1001,9,3,9,102,3,9,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,102,2,9,9,4,9,99,3,9,102,4,9,9,101,5,9,9,102,2,9,9,101,5,9,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,1,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,99},
			{3,8,1001,8,10,8,105,1,0,0,21,38,63,88,97,118,199,280,361,442,99999,3,9,1002,9,3,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,101,3,9,9,102,5,9,9,101,3,9,9,1002,9,3,9,101,3,9,9,4,9,99,3,9,1002,9,2,9,1001,9,3,9,102,3,9,9,101,2,9,9,1002,9,4,9,4,9,99,3,9,102,2,9,9,4,9,99,3,9,102,4,9,9,101,5,9,9,102,2,9,9,101,5,9,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,99,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,1,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,102,2,9,9,4,9,99,3,9,102,2,9,9,4,9,3,9,101,1,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1002,9,2,9,4,9,3,9,102,2,9,9,4,9,3,9,1002,9,2,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,1,9,9,4,9,99,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,101,1,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,3,9,101,2,9,9,4,9,3,9,102,2,9,9,4,9,3,9,1001,9,1,9,4,9,3,9,1001,9,2,9,4,9,99},
	};
	/*int i[][29] = { {3,26,1001,26,-4,26,3,27,1002,27,2,27,1,27,26,27,4,27,1001,28,-1,28,1005,28,6,99,0,0,5},
{3,26,1001,26,-4,26,3,27,1002,27,2,27,1,27,26,27,4,27,1001,28,-1,28,1005,28,6,99,0,0,5},
{3,26,1001,26,-4,26,3,27,1002,27,2,27,1,27,26,27,4,27,1001,28,-1,28,1005,28,6,99,0,0,5},
{3,26,1001,26,-4,26,3,27,1002,27,2,27,1,27,26,27,4,27,1001,28,-1,28,1005,28,6,99,0,0,5},
{3,26,1001,26,-4,26,3,27,1002,27,2,27,1,27,26,27,4,27,1001,28,-1,28,1005,28,6,99,0,0,5}};
*/
	int amp = 0;
	int x[] = {0, 0, 0, 0, 0};
	int com = 0;
	int valA = 0;
	int valB = 0;
	int desC = 0;
	int done = -1;
	while(x[amp%5] < 678 && done == -1){
		//printf("here\n");
		com = i[amp%5][x[amp%5]];
		printf("     %d   %d\n", com, x[amp%5]);
		int comand = com%100;
		//printf("comand = %d\n", comand);
		//printf("x = %d\n", x);
		com = com/100;
		int pa = com%10;
		int pb = com/10%10;
		int pc = com/100%10;
		if(comand < 3){
			if(pa == 0){
				valA = i[amp%5][i[amp%5][x[amp%5]+1]];
			}else{
				valA = i[amp%5][x[amp%5]+1];
			}
			if(pb == 0){
				valB = i[amp%5][i[amp%5][x[amp%5]+2]];
			}else{
				valB = i[amp%5][x[amp%5]+2];
			}
			desC = i[amp%5][x[amp%5]+3];
			
			if(comand == 1){
				i[amp%5][desC] = valA + valB;
				//printf("add %d + %d\n", valA, valB);
			}else if( comand == 2){
				i[amp%5][desC] = valA *valB;
			}
			x[amp%5] = x[amp%5] + 4;
		}else if(comand < 5){
			//printf("here\n");
			desC = i[amp%5][x[amp%5]+1];
			x[amp%5] = x[amp%5] + 2;
			if(comand == 3){
				if(first[amp%5]){
				//printf("here\n");
				i[amp%5][desC] = inputa[amp%5];
				first[amp%5] = false;
				}else{
				i[amp%5][desC] = inputb;
				}
			}else{
				output = i[amp%5][desC];
				printf("output = %d\n", output);
				inputb = output;
				amp++;
			}
		}else if(comand < 7){
			if(pa == 0){
				valA = i[amp%5][i[amp%5][x[amp%5]+1]];
			}else{
				valA = i[amp%5][x[amp%5]+1];
			}
			if(pb == 0){
				valB = i[amp%5][i[amp%5][x[amp%5]+2]];
			}else{
				valB = i[amp%5][x[amp%5]+2];
			}
			if(comand == 5){
				if(valA == 0){
					x[amp%5] = x[amp%5] + 3;
				}else{
					x[amp%5] = valB;
				}
			}else{
				if(valA != 0){
					x[amp%5] = x[amp%5] + 3;
				}else{
					x[amp%5] = valB;
				}
			}
		}else if(comand < 9){
			desC = i[amp%5][x[amp%5]+3];
			if(pa == 0){
				valA = i[amp%5][i[amp%5][x[amp%5]+1]];
			}else{
				valA = i[amp%5][x[amp%5]+1];
			}
			if(pb == 0){
				valB = i[amp%5][i[amp%5][x[amp%5]+2]];
			}else{
				valB = i[amp%5][x[amp%5]+2];
			}
			if(comand == 7){
				if(valA < valB){
					i[amp%5][desC] = 1;
				}else{
					i[amp%5][desC] = 0;
				}
			}else{
				if(valA == valB){
					i[amp%5][desC] = 1;
				}else{
					i[amp%5][desC] = 0;
				}
			}
			x[amp%5] = x[amp%5] + 4;
		}else if(comand == 99){
			printf("halt\n");
			//done = 0;
			xx++;
			amp++;
			if(xx>4){
				done = 0;
			}
		}else{
			printf("error\n");
			return;
			done = 1;
		}
	}
	//inputb = output;
	}
	if(output > max){
		max = output;
	}
	}
	zz++;
	}
	printf("%d done\n", max);

}


int main(int argc, char* argv[]){
	//partOne();
	partTwo();
	return 0;
}